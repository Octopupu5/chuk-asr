# chuk-asr - система автоматического распознавания речи для чукотского языка

## Описание

Проект реализует полный цикл создания и тестирования системы автоматического распознавания речи для чукотского языка на основе: wav2vec2-large-960h, wav2vec2-large-xlsr-53, mms-1b.

### Данные
- Датасет должен представлять собой CSV-файл с колонками `audio_path` (пути к звуковым файлам) и `text` (транскрипции) и должен находиться в корне проекта.
- Скрипты автоматически нормализуют пути (замена `\` на `/`).
- Для каждого проекта создаётся символьный словарь, в котором учитываются все встречающиеся символы из транскрипций, а также добавляются служебные токены.
- Каждая строка датасета преобразуется в набор числовых признаков для входа в модель и числовых меток для CTC-loss.

### Модель

- Модели загружаются из HuggingFace Hub (`facebook/wav2vec2-large-960h`, `facebook/wav2vec2-large-xlsr-53`, `facebook/mms-1b-all`).
- При необходимости некоторые слои "замораживаются", чтобы ускорить дообучение.

### Обучение

- Настройка параметров обучения: стратегия сохранения чекпойнтов, размер батча, lr_scheduler, etc.
- Функция расчета метрик (WER, CER).

### Сохранение модели

- Все чекпоинты и финальные веса сохраняются в указанные директории.

### Оценка качества модели

- После обучения проводится тестирование на валидационной части.
- Рассчитываются значения WER и CER.
- Для каждого примера сохраняются реальные и предсказанные транскрипции.
- Для нового аудио доступны простые функции инференса, возвращающие текстовые транскрипции:

```
from asr_inference import simple_transcribe
simple_transcribe("audio.wav", "путь-до-модели")
```

### Структура файлов

- `asr_utils.py` - вспомогательные функции: создание словаря, загрузка аудио, паддинг, функции метрик.
- `asr_inference.py` - функции для инференса, вычисления WER/СER и удобный класс ASR.
- `XLSR-53.ipynb`, `mms-1b.ipynb`, `wav2vec2.ipynb` - основные эксперименты по дообучению моделей.
- Обучающие и итоговые модели рекомендуется хранить в подпапках `./trained/...`.
- Файлы с метриками и примерами написания результатов - в папке `./results/...`

### Основные зависимости

- Python
- torch
- pandas
- numpy
- librosa
- transformers
- datasets
- jiwer